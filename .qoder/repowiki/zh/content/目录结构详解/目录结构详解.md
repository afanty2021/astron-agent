# 目录结构详解

<cite>
**本文档引用的文件**
- [README.md](file://README.md)
- [CONTRIBUTING.md](file://CONTRIBUTING.md)
- [Makefile](file://Makefile)
- [console/backend/pom.xml](file://console/backend/pom.xml)
- [console/frontend/package.json](file://console/frontend/package.json)
- [core/agent/main.py](file://core/agent/main.py)
- [core/common/pyproject.toml](file://core/common/pyproject.toml)
- [core/knowledge/main.py](file://core/knowledge/main.py)
- [core/tenant/main.go](file://core/tenant/main.go)
- [core/workflow/main.py](file://core/workflow/main.py)
- [docker/astronAgent/docker-compose-with-auth.yaml](file://docker/astronAgent/docker-compose-with-auth.yaml)
- [makefiles/core/detection.mk](file://makefiles/core/detection.mk)
- [makefiles/core/workflows.mk](file://makefiles/core/workflows.mk)
- [console/backend/hub/Dockerfile](file://console/backend/hub/Dockerfile)
- [console/frontend/Dockerfile](file://console/frontend/Dockerfile)
- [core/agent/Dockerfile](file://core/agent/Dockerfile)
- [core/knowledge/Dockerfile](file://core/knowledge/Dockerfile)
- [core/memory/database/Dockerfile](file://core/memory/database/Dockerfile)
- [core/plugin/aitools/Dockerfile](file://core/plugin/aitools/Dockerfile)
- [core/plugin/link/Dockerfile](file://core/plugin/link/Dockerfile)
- [core/plugin/rpa/Dockerfile](file://core/plugin/rpa/Dockerfile)
- [core/tenant/Dockerfile](file://core/tenant/Dockerfile)
- [core/workflow/Dockerfile](file://core/workflow/Dockerfile)
</cite>

## 目录结构

- [简介](#简介)
- [项目总体结构](#项目总体结构)
- [console/ 目录](#console-目录)
  - [前端组织方式](#前端组织方式)
  - [后端组织方式](#后端组织方式)
- [core/ 目录](#core-目录)
  - [agent 微服务](#agent-微服务)
  - [knowledge 微服务](#knowledge-微服务)
  - [workflow 微服务](#workflow-微服务)
  - [tenant 微服务](#tenant-微服务)
  - [common 公共库](#common-公共库)
- [docker/ 目录](#docker-目录)
- [makefiles/ 目录](#makefiles-目录)
- [总结](#总结)

## 简介

Astron Agent 是一个企业级、商业友好的 Agentic Workflow 开发平台，集成了AI工作流编排、模型管理、AI和MCP工具集成、RPA自动化和团队协作功能。本文档将全面解析项目的目录结构，详细说明各主要目录的职责和内容。

**Section sources**
- [README.md](file://README.md#L1-L128)

## 项目总体结构

项目采用微服务架构，主要分为控制台（console）、核心服务（core）、Docker部署配置（docker）和构建脚本（makefiles）四大模块。整体结构清晰，各模块职责分明。

```mermaid
graph TD
A[项目根目录] --> B[console]
A --> C[core]
A --> D[docker]
A --> E[makefiles]
A --> F[README.md]
A --> G[CONTRIBUTING.md]
A --> H[Makefile]
B --> B1[backend]
B --> B2[frontend]
C --> C1[agent]
C --> C2[common]
C --> C3[knowledge]
C --> C4[memory]
C --> C5[plugin]
C --> C6[tenant]
C --> C7[workflow]
D --> D1[astronAgent]
D --> D2[ragflow]
E --> E1[check-comments.sh]
E --> E2[localci.toml]
E --> E3[parse_localci.sh]
```

**Diagram sources**
- [CONTRIBUTING.md](file://CONTRIBUTING.md#L1-L408)

## console/ 目录

console 目录包含平台的前后端代码，分为 backend 和 frontend 两个子目录，分别对应后端Java服务和前端TypeScript应用。

### 前端组织方式

前端采用React + TypeScript技术栈，使用Vite作为构建工具。src目录下按功能模块组织代码，主要包含组件、服务、状态管理等子目录。

```mermaid
graph TD
Frontend[frontend] --> Public[public]
Frontend --> Src[src]
Frontend --> Config[配置文件]
Src --> Components[components]
Src --> Config[config]
Src --> Constants[constants]
Src --> Hooks[hooks]
Src --> I18n[i18n]
Src --> Layouts[layouts]
Src --> Locales[locales]
Src --> Pages[pages]
Src --> Permissions[permissions]
Src --> Router[router]
Src --> Services[services]
Src --> Store[store]
Src --> Styles[styles]
Src --> Types[types]
Src --> Utils[utils]
Src --> App[app.tsx]
Src --> Main[main.tsx]
Components --> Agent[agent-creation]
Components --> Bot[bot-center]
Components --> Button[button-group]
Components --> Modal[modal]
Components --> Sidebar[sidebar]
Components --> Space[space]
Components --> Workflow[workflow]
Pages --> Bot[bot-api]
Pages --> Chat[chat-page]
Pages --> Home[home-page]
Pages --> Model[model-management]
Pages --> Plugin[plugin-store]
Pages --> Space[space]
Pages --> Workflow[workflow]
Store --> Agent[agent-directive-create]
Store --> Bot[bot-info-store]
Store --> Chat[chat-store]
Store --> Global[global-store]
Store --> User[user-store]
```

**Diagram sources**
- [console/frontend/package.json](file://console/frontend/package.json#L1-L136)

### 后端组织方式

后端采用Java Spring Boot框架，使用Maven进行项目管理。backend目录下包含多个子模块，通过pom.xml进行依赖管理。

```mermaid
graph TD
Backend[backend] --> Commons[commons]
Backend --> Config[config]
Backend --> Hub[hub]
Backend --> Toolkit[toolkit]
Backend --> Parent[pom.xml]
Commons --> Src[src]
Commons --> Pom[pom.xml]
Hub --> Src[src]
Hub --> Dockerfile[Dockerfile]
Hub --> Pom[pom.xml]
Toolkit --> Src[src]
Toolkit --> Pom[pom.xml]
Config --> Checkstyle[checkstyle.xml]
Config --> Eclipse[eclipse-formatter.xml]
Config --> PMD[pmd-ruleset.xml]
Config --> Spotbugs[spotbugs-exclude.xml]
```

**Diagram sources**
- [console/backend/pom.xml](file://console/backend/pom.xml#L1-L343)

## core/ 目录

core 目录包含平台的核心微服务，每个微服务独立运行，通过API进行通信。这些微服务构成了平台的核心功能。

### agent 微服务

agent 微服务是平台的代理执行引擎，负责处理智能代理的核心逻辑。采用Python开发，使用FastAPI框架。

```mermaid
graph TD
Agent[agent] --> API[api]
Agent --> Cache[cache]
Agent --> Domain[domain]
Agent --> Engine[engine]
Agent --> Exceptions[exceptions]
Agent --> Infra[infra]
Agent --> Repository[repository]
Agent --> Scripts[scripts]
Agent --> Service[service]
Agent --> Tests[tests]
Agent --> Dockerfile[Dockerfile]
Agent --> Main[main.py]
Agent --> Pyproject[pyproject.toml]
API --> Schemas[schemas]
API --> Utils[utils]
API --> V1[v1]
API --> App[app.py]
Domain --> Models[models]
Engine --> Nodes[nodes]
Engine --> Runner[workflow_agent_runner.py]
Service --> Builder[builder]
Service --> Plugin[plugin]
Service --> Runner[runner]
```

**Diagram sources**
- [core/agent/main.py](file://core/agent/main.py#L1-L109)
- [core/agent/Dockerfile](file://core/agent/Dockerfile)

### knowledge 微服务

knowledge 微服务负责知识库服务，提供RAG（检索增强生成）功能。采用Python开发，使用FastAPI框架。

```mermaid
graph TD
Knowledge[knowledge] --> API[api]
Knowledge --> Consts[consts]
Knowledge --> Domain[domain]
Knowledge --> Exceptions[exceptions]
Knowledge --> Infra[infra]
Knowledge --> Service[service]
Knowledge --> Tests[tests]
Knowledge --> Utils[utils]
Knowledge --> Dockerfile[Dockerfile]
Knowledge --> Main[main.py]
Knowledge --> Pyproject[pyproject.toml]
API --> V1[v1]
Domain --> Entity[entity]
Domain --> Response[response]
Infra --> Aiui[aiui]
Infra --> Desk[desk]
Infra --> Ragflow[ragflow]
Infra --> Xinghuo[xinghuo]
Service --> Impl[impl]
Service --> Strategy[rag_strategy]
Service --> Factory[rag_strategy_factory]
```

**Diagram sources**
- [core/knowledge/main.py](file://core/knowledge/main.py#L1-L112)
- [core/knowledge/Dockerfile](file://core/knowledge/Dockerfile)

### workflow 微服务

workflow 微服务是平台的工作流编排引擎，负责管理复杂的工作流逻辑。采用Python开发，使用FastAPI框架。

```mermaid
graph TD
Workflow[workflow] --> API[api]
Workflow --> Cache[cache]
Workflow --> Configs[configs]
Workflow --> Consts[consts]
Workflow --> Domain[domain]
Workflow --> Engine[engine]
Workflow --> Exception[exception]
Workflow --> Extensions[extensions]
Workflow --> Infra[infra]
Workflow --> Repository[repository]
Workflow --> Service[service]
Workflow --> Tests[tests]
Workflow --> Utils[utils]
Workflow --> Dockerfile[Dockerfile]
Workflow --> Main[main.py]
Workflow --> Pyproject[pyproject.toml]
API --> V1[v1]
Domain --> Entities[entities]
Domain --> Models[models]
Engine --> Callbacks[callbacks]
Engine --> Entities[entities]
Engine --> Nodes[nodes]
Engine --> Dsl[dsl_engine.py]
Engine --> Node[node.py]
Extensions --> Fastapi[fastapi]
Extensions --> Graceful[graceful_shutdown]
Extensions --> Middleware[middleware]
Extensions --> Otlp[otlp]
Infra --> Audit[audit_system]
Infra --> Providers[providers/llm]
Service --> App[app_service.py]
Service --> Audit[audit_service.py]
Service --> Auth[auth_service.py]
Service --> Chat[chat_service.py]
Service --> File[file_service.py]
Service --> Flow[flow_service.py]
Service --> History[history_service.py]
Service --> License[license_service.py]
Service --> Ops[ops_service.py]
Service --> Publish[publish_service.py]
```

**Diagram sources**
- [core/workflow/main.py](file://core/workflow/main.py#L1-L167)
- [core/workflow/Dockerfile](file://core/workflow/Dockerfile)

### tenant 微服务

tenant 微服务负责多租户管理，采用Go语言开发，体现了平台对多语言技术栈的支持。

```mermaid
graph TD
Tenant[tenant] --> App[app]
Tenant --> Config[config]
Tenant --> Internal[internal]
Tenant --> Tools[tools]
Tenant --> Dockerfile[Dockerfile]
Tenant --> ConfigToml[config.toml]
Tenant --> GoMod[go.mod]
Tenant --> GoSum[go.sum]
Tenant --> Main[main.go]
App --> Server[server.go]
Config --> ConfigGo[config.go]
Config --> Env[env_loader.go]
Config --> Loader[loader.go]
Config --> Local[local_loader.go]
Internal --> Dao[dao]
Internal --> Handler[handler]
Internal --> Models[models]
Internal --> Service[service]
Tools --> Database[database]
Tools --> Generator[generator]
```

**Diagram sources**
- [core/tenant/main.go](file://core/tenant/main.go#L1-L14)
- [core/tenant/Dockerfile](file://core/tenant/Dockerfile)

### common 公共库

common 目录包含多个微服务共享的公共库和工具，确保代码的复用性和一致性。

```mermaid
graph TD
Common[common] --> Audit[audit_system]
Common --> Exceptions[exceptions]
Common --> Initialize[initialize]
Common --> Metrology[metrology_auth]
Common --> Otlp[otlp]
Common --> Service[service]
Common --> Settings[settings]
Common --> Tests[tests]
Common --> Utils[utils]
Common --> README[README.md]
Common --> MaSdk[ma-sdk.toml]
Common --> Pyproject[pyproject.toml]
Common --> UvLock[uv.lock]
Audit --> Api[audit_api]
Audit --> Strategy[strategy]
Audit --> Base[base.py]
Audit --> Enums[enums.py]
Audit --> Orchestrator[orchestrator.py]
Audit --> Utils[utils.py]
Exceptions --> Base[base.py]
Exceptions --> Codes[codes.py]
Exceptions --> Errs[errs.py]
Metrology --> Include[include]
Metrology --> Base[base.py]
Metrology --> Calc[calc.py]
Metrology --> Conc[conc.py]
Metrology --> Errors[errors.py]
Metrology --> Licc[licc.py]
Metrology --> MaSdk[ma-sdk.toml]
Metrology --> Rep[rep.py]
Otlp --> Args[args]
Otlp --> Log[log_trace]
Otlp --> Metrics[metrics]
Otlp --> Trace[trace]
Otlp --> Ip[ip.py]
Otlp --> Sid[sid.py]
Service --> Cache[cache]
Service --> Db[db]
Service --> Kafka[kafka]
Service --> Log[log]
Service --> Ma[ma]
Service --> Oss[oss]
Service --> Otlp[otlp]
Service --> Settings[settings]
Service --> Base[base.py]
Service --> Utils[utils.py]
Settings --> Polaris[polaris.py]
Settings --> Settings[settings.py]
Utils --> Json[json_schema]
Utils --> Hmac[hmac_auth.py]
Utils --> Snowfake[snowfake.py]
```

**Diagram sources**
- [core/common/pyproject.toml](file://core/common/pyproject.toml#L1-L53)

## docker/ 目录

docker 目录包含平台的Docker部署配置文件，通过docker-compose实现多服务的协同工作。

```mermaid
graph TD
Docker[docker] --> AstronAgent[astronAgent]
Docker --> Ragflow[ragflow]
AstronAgent --> AstronRPA[astronRPA]
AstronAgent --> Casdoor[casdoor]
AstronAgent --> Config[config]
AstronAgent --> Mysql[mysql]
AstronAgent --> Nginx[nginx]
AstronAgent --> Pgsql[pgsql]
AstronAgent --> Compose[docker-compose*.yaml]
AstronRPA --> Volumes[volumes]
AstronRPA --> Compose[docker-compose.yml]
Casdoor --> Conf[conf]
Casdoor --> Entrypoint[entrypoint.sh]
Config --> Tenant[tenant/config.toml]
Mysql --> Agent[agent.sql]
Mysql --> Link[link.sql]
Mysql --> Tenant[tenant.sql]
Mysql --> Workflow[workflow.sql]
Nginx --> NginxConf[nginx.conf]
Pgsql --> Memory[memory.sql]
Ragflow --> Nginx[nginx]
Ragflow --> Compose[docker-compose*.yml]
Ragflow --> Entrypoint[entrypoint.sh]
Ragflow --> Init[init.sql]
Ragflow --> Launch[launch_backend_service.sh]
Ragflow --> Migration[migration.sh]
Nginx --> NginxConf[nginx.conf]
Nginx --> Proxy[proxy.conf]
Nginx --> RagflowConf[ragflow.conf]
Nginx --> RagflowHttps[ragflow.https.conf]
```

**Diagram sources**
- [docker/astronAgent/docker-compose-with-auth.yaml](file://docker/astronAgent/docker-compose-with-auth.yaml#L1-L14)

## makefiles/ 目录

makefiles 目录包含项目的构建脚本，提供了一套智能化的CI/CD工具链，简化了开发流程。

```mermaid
graph TD
Makefiles[makefiles] --> Core[core]
Makefiles --> Go[go.mk]
Makefiles --> Typescript[typescript.mk]
Makefiles --> Java[java.mk]
Makefiles --> Python[python.mk]
Makefiles --> Git[git.mk]
Makefiles --> Common[common.mk]
Makefiles --> Comment[comment-check.mk]
Makefiles --> Check[check-comments.sh]
Makefiles --> Localci[localci.toml]
Makefiles --> Parse[parse_localci.sh]
Core --> Detection[detection.mk]
Core --> Workflows[workflows.mk]
Detection --> Detect[detect_active_projects]
Detection --> Context[detect_current_context]
Detection --> Colors[color detection]
Detection --> Status[show_project_status]
Workflows --> Setup[smart_setup]
Workflows --> Format[smart_format]
Workflows --> Check[smart_check]
Workflows --> Test[smart_test]
Workflows --> Build[smart_build]
Workflows --> Push[smart_push]
Workflows --> Clean[smart_clean]
Workflows --> Ci[smart_ci]
Workflows --> Fix[smart_fix]
Workflows --> Status[smart_status]
Workflows --> Info[smart_info]
```

**Diagram sources**
- [makefiles/core/detection.mk](file://makefiles/core/detection.mk#L1-L138)
- [makefiles/core/workflows.mk](file://makefiles/core/workflows.mk#L1-L307)

## 总结

Astron Agent项目采用清晰的微服务架构，各目录职责分明：
- **console/**: 平台的前后端代码，采用Java和TypeScript技术栈
- **core/**: 核心微服务，包括agent、knowledge、workflow、tenant等，采用Python和Go语言
- **docker/**: Docker部署配置，通过docker-compose实现多服务协同
- **makefiles/**: 构建脚本，提供智能化的CI/CD工具链

这种结构设计使得项目易于维护和扩展，不同技术栈的微服务可以独立开发和部署，同时通过统一的构建和部署流程保证了整体的一致性。